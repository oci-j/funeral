import{r as _,D as A,m as V,c as T,o as y,a as r,g as x,b as L,d as a,t as p,w as o,s as i,j as S,u as g,G,l as K,F as j,H,h as J,B as w,C as m,z as N,I as q,J as z,K as O,k as Q,L as W,i as X,A as Y}from"./index-DATKbadj.js";/* empty css                 */import{_ as Z}from"./el-input-BtvPs5Ei.js";/* empty css                */import{u as ee}from"./useAuthCheck-ee9Km1YY.js";const te={class:"repository-container"},ae={class:"page-header"},oe={class:"card-header"},ne={class:"tag-name"},se={class:"header-actions"},le={class:"tag-details"},re={class:"detail-item"},ie={class:"detail-item"},ce={class:"pull-command"},de={__name:"Repository",setup(ue){const B=A(),v=N(),c=_(decodeURIComponent(B.params.name)),d=_([]),f=_(!1),k=_(null),$=async()=>{f.value=!0;try{const e=await w.getRepositoryTags(c.value);if(e.tags){const t=await Promise.allSettled(e.tags.map(async n=>{try{const l=await w.getManifestInfo(c.value,n);return{name:n,digest:l.digest||"Unknown",size:l.contentLength||"Unknown",created:l.createdAt||"Unknown"}}catch{return{name:n,digest:"Unknown",size:"Unknown",created:"Unknown"}}}));d.value=t.filter(n=>n.status==="fulfilled").map(n=>n.value)}else d.value=[]}catch(e){m.error("Failed to fetch repository tags"),console.error("Error fetching repository tags:",e)}finally{f.value=!1}},C=e=>`docker pull ${window.location.hostname}:${window.location.port||80}/${c.value}:${e.name}`,D=async e=>{try{await navigator.clipboard.writeText(e),m.success("Copied to clipboard")}catch{m.error("Failed to copy to clipboard")}},E=e=>e==="Unknown"?e:e<1024?`${e} B`:e<1024*1024?`${(e/1024).toFixed(2)} KB`:e<1024*1024*1024?`${(e/(1024*1024)).toFixed(2)} MB`:`${(e/(1024*1024*1024)).toFixed(2)} GB`,U=async e=>{try{await Y.confirm(`Are you sure you want to delete tag "${e}"?`,"Delete Tag",{confirmButtonText:"Delete",cancelButtonText:"Cancel",type:"warning"}),k.value=e,await w.deleteTag(c.value,e),m.success(`Tag "${e}" deleted successfully`),d.value=d.value.filter(t=>t.name!==e)}catch(t){t!=="cancel"&&m.error(`Failed to delete tag "${e}": ${t.message}`)}finally{k.value=null}},b=e=>{v.push({name:"TagDetail",params:{name:c.value,tag:e}})},F=()=>{v.back()},{initPage:I}=ee(v,$,{loading:f});return V(()=>{I()}),(e,t)=>{const n=S,l=K,u=q,R=z,P=X,M=J;return y(),T("div",te,[r("div",ae,[r("h1",null,p(c.value),1),a(l,{onClick:F},{default:o(()=>[a(n,null,{default:o(()=>[a(g(G))]),_:1}),t[0]||(t[0]=i(" Back ",-1))]),_:1})]),(y(!0),T(j,null,H(d.value,s=>(y(),x(P,{class:"tag-card",key:s.name},{header:o(()=>[r("div",oe,[r("span",ne,p(s.name),1),r("div",se,[a(u,{type:"info",size:"small"},{default:o(()=>[i(p(E(s.size)),1)]),_:2},1024),a(l,{type:"primary",size:"small",onClick:h=>b(s.name)},{default:o(()=>[a(n,null,{default:o(()=>[a(g(Q))]),_:1}),t[1]||(t[1]=i(" Details ",-1))]),_:1},8,["onClick"]),a(l,{type:"danger",size:"small",onClick:h=>U(s.name),loading:k.value===s.name},{default:o(()=>[a(n,null,{default:o(()=>[a(g(W))]),_:1}),t[2]||(t[2]=i(" Delete ",-1))]),_:1},8,["onClick","loading"])])])]),default:o(()=>[r("div",le,[r("div",re,[a(u,{type:"info"},{default:o(()=>[...t[3]||(t[3]=[i("Created:",-1)])]),_:1}),a(u,null,{default:o(()=>[i(p(s.created||"Unknown"),1)]),_:2},1024)]),r("div",ie,[a(u,{type:"info"},{default:o(()=>[...t[4]||(t[4]=[i("Digest:",-1)])]),_:1}),a(u,{class:"digest-text"},{default:o(()=>[i(p(s.digest),1)]),_:2},1024)]),r("div",ce,[a(u,{type:"info"},{default:o(()=>[...t[5]||(t[5]=[i("Pull Command:",-1)])]),_:1}),a(R,{"model-value":C(s),readonly:"",class:"command-input"},{append:o(()=>[a(l,{onClick:h=>D(C(s))},{default:o(()=>[a(n,null,{default:o(()=>[a(g(O))]),_:1})]),_:1},8,["onClick"])]),_:2},1032,["model-value"])])])]),_:2},1024))),128)),!f.value&&d.value.length===0?(y(),x(M,{key:0,description:"No tags found"})):L("",!0)])}}},ge=Z(de,[["__scopeId","data-v-938c9fc5"]]);export{ge as default};
