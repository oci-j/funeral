import{S as C,r as d,T as F,c as w,a as c,f as o,g as a,Q as N,U as S,d as b,e as f,b as _,C as q,V,R as I,W as K,h as g,j as M,t as P,L as T,B as D,H as j,n as z,y as H,p as Q}from"./index-BKVBmhn8.js";/* empty css                *//* empty css                     *//* empty css                *//* empty css                 *//* empty css                    */import{_ as W}from"./_plugin-vue_export-helper-sTCA9qUK.js";const G={class:"login-container"},J={key:2,class:"error-message"},O={class:"login-info"},X={__name:"Login",setup(Y){const E=Q(),x=H(),v=C(),m=d(),p=d(!1),n=d(""),s=d(!1),l=F({username:"",password:""}),A={username:[{required:!0,message:"Please input username",trigger:"blur"}],password:[{required:!0,message:"Please input password",trigger:"blur"}]},u=async()=>{if(!(!s.value&&!m.value)&&!(!s.value&&!await m.value.validate())){p.value=!0,n.value="";try{let t;if(s.value?t=await v.loginAnonymous():t=await v.login(l.username,l.password),t.success){z.success(s.value?"Anonymous access enabled":"Login successful");const e=x.query.redirect||"/";E.push(e)}else n.value=t.error||(s.value?"Anonymous access failed":"Login failed")}catch(t){n.value=t.message||(s.value?"Anonymous access failed":"Login failed")}finally{p.value=!1}}};return l.username="admin",l.password="password",(t,e)=>{const y=q,i=I,h=K,k=M,L=T,R=D,U=N,B=j;return c(),w("div",G,[o(B,{class:"login-card"},{header:a(()=>[...e[3]||(e[3]=[_("div",{class:"login-header"},[_("h2",null,"FUNERAL Registry Login")],-1)])]),default:a(()=>[o(U,{ref_key:"loginFormRef",ref:m,model:l,rules:s.value?{}:A,"label-width":"80px",class:"login-form",onSubmit:S(u,["prevent"])},{default:a(()=>[s.value?f("",!0):(c(),b(i,{key:0,label:"Username",prop:"username"},{default:a(()=>[o(y,{modelValue:l.username,"onUpdate:modelValue":e[0]||(e[0]=r=>l.username=r),placeholder:"Enter username","prefix-icon":"User",onKeyup:V(u,["enter"])},null,8,["modelValue"])]),_:1})),s.value?f("",!0):(c(),b(i,{key:1,label:"Password",prop:"password"},{default:a(()=>[o(y,{modelValue:l.password,"onUpdate:modelValue":e[1]||(e[1]=r=>l.password=r),type:"password",placeholder:"Enter password","prefix-icon":"Lock","show-password":"",onKeyup:V(u,["enter"])},null,8,["modelValue"])]),_:1})),o(i,null,{default:a(()=>[o(h,{modelValue:s.value,"onUpdate:modelValue":e[2]||(e[2]=r=>s.value=r)},{default:a(()=>[...e[4]||(e[4]=[g(" Anonymous Access ",-1)])]),_:1},8,["modelValue"])]),_:1}),o(i,null,{default:a(()=>[o(k,{type:"primary",loading:p.value,class:"login-button",onClick:u},{default:a(()=>[g(P(s.value?"Access as Anonymous":"Login"),1)]),_:1},8,["loading"])]),_:1}),n.value?(c(),w("div",J,[o(L,{title:n.value,type:"error",closable:!1,"show-icon":""},null,8,["title"])])):f("",!0),_("div",O,[o(R,{type:"info",size:"small"},{default:a(()=>[...e[5]||(e[5]=[g(" Default credentials: admin / password ",-1)])]),_:1})])]),_:1},8,["model","rules"])]),_:1})])}}},te=W(X,[["__scopeId","data-v-17bd6a24"]]);export{te as default};
