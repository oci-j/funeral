import{aa as U,r as d,ag as B,c as w,o as c,d as o,w as a,ae as N,ah as I,g as b,b as f,a as _,J as S,ai as E,af as q,aj as D,s as g,l as K,t as M,Q as P,I as z,i as T,C as j,D as J,z as Q}from"./index-C9i3Hfag.js";import{_ as G}from"./el-input-BtvPs5Ei.js";/* empty css                     *//* empty css                *//* empty css                 *//* empty css                    */const H={class:"login-page"},O={key:2,class:"error-message"},W={class:"login-info"},X={__name:"Login",setup(Y){const V=Q(),x=J(),v=U(),m=d(),p=d(!1),n=d(""),s=d(!1),l=B({username:"",password:""}),A={username:[{required:!0,message:"Please input username",trigger:"blur"}],password:[{required:!0,message:"Please input password",trigger:"blur"}]},u=async()=>{if(!(!s.value&&!m.value)&&!(!s.value&&!await m.value.validate())){p.value=!0,n.value="";try{let t;if(s.value?t=await v.loginAnonymous():t=await v.login(l.username,l.password),t.success){j.success(s.value?"Anonymous access enabled":"Login successful");const e=x.query.redirect||"/";V.push(e)}else n.value=t.error||(s.value?"Anonymous access failed":"Login failed")}catch(t){n.value=t.message||(s.value?"Anonymous access failed":"Login failed")}finally{p.value=!1}}};return l.username="admin",l.password="password",(t,e)=>{const y=S,i=q,h=D,k=K,L=P,R=z,C=N,F=T;return c(),w("div",H,[o(F,{class:"login-card"},{header:a(()=>[...e[3]||(e[3]=[_("div",{class:"login-header"},[_("h2",null,"FUNERAL Registry Login")],-1)])]),default:a(()=>[o(C,{ref_key:"loginFormRef",ref:m,model:l,rules:s.value?{}:A,"label-width":"80px",class:"login-form",onSubmit:I(u,["prevent"])},{default:a(()=>[s.value?f("",!0):(c(),b(i,{key:0,label:"Username",prop:"username"},{default:a(()=>[o(y,{modelValue:l.username,"onUpdate:modelValue":e[0]||(e[0]=r=>l.username=r),placeholder:"Enter username","prefix-icon":"User",onKeyup:E(u,["enter"])},null,8,["modelValue"])]),_:1})),s.value?f("",!0):(c(),b(i,{key:1,label:"Password",prop:"password"},{default:a(()=>[o(y,{modelValue:l.password,"onUpdate:modelValue":e[1]||(e[1]=r=>l.password=r),type:"password",placeholder:"Enter password","prefix-icon":"Lock","show-password":"",onKeyup:E(u,["enter"])},null,8,["modelValue"])]),_:1})),o(i,null,{default:a(()=>[o(h,{modelValue:s.value,"onUpdate:modelValue":e[2]||(e[2]=r=>s.value=r)},{default:a(()=>[...e[4]||(e[4]=[g(" Anonymous Access ",-1)])]),_:1},8,["modelValue"])]),_:1}),o(i,null,{default:a(()=>[o(k,{type:"primary",loading:p.value,class:"login-button",onClick:u},{default:a(()=>[g(M(s.value?"Access as Anonymous":"Login"),1)]),_:1},8,["loading"])]),_:1}),n.value?(c(),w("div",O,[o(L,{title:n.value,type:"error",closable:!1,"show-icon":""},null,8,["title"])])):f("",!0),_("div",W,[o(R,{type:"info",size:"small"},{default:a(()=>[...e[5]||(e[5]=[g(" Default credentials: admin / password ",-1)])]),_:1})])]),_:1},8,["model","rules"])]),_:1})])}}},le=G(X,[["__scopeId","data-v-5e409020"]]);export{le as default};
