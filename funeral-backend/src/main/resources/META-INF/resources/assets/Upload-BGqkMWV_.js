import{r as m,I as w,c as b,a as f,b as a,f as t,g as l,e as I,J as q,E as G,u as h,K as J,h as n,j as K,L as Q,M as X,N as Y,F as Z,A as ee,t as E,s as te,l as le,O as ae,H as oe,P as se,B as ne,C as re,D as R,Q as de,R as ue,n as _,S as ie,d as pe}from"./index-B7TKjTeB.js";/* empty css                     */import{_ as ce}from"./_plugin-vue_export-helper-sTCA9qUK.js";/* empty css                *//* empty css                *//* empty css               *//* empty css                    *//* empty css                 */const me={class:"upload-container"},fe={class:"card-header"},_e={class:"upload-section"},ve={class:"upload-actions"},ge={key:0,class:"upload-result"},ye={key:0,class:"result-details"},be={key:0,class:"manifest-list"},ke={class:"upload-content"},we={class:"step"},he={class:"step-content"},Ee={class:"step"},Ue={class:"step-content"},Ve={class:"step"},Te={class:"step-content"},ze={__name:"Upload",setup(Ce){const N=m(),u=m([]),U=m(!1),r=m(null),v=m("my-app"),g=m("latest"),V=w(()=>{const{hostname:s,port:e}=window.location;return e&&e!=="80"?`${s}:${e}`:s}),T=w(()=>`docker tag ${v.value}:${g.value} ${V.value}/${v.value}:${g.value}`),z=w(()=>`docker push ${V.value}/${v.value}:${g.value}`),C=w(()=>`docker login ${V.value}`),P=s=>s.name.endsWith(".tar")||s.name.endsWith(".tar.gz")||s.name.endsWith(".tgz")||s.name.endsWith(".zip")?!0:(_.error("Only .tar, .tar.gz, .tgz, and .zip files are supported"),!1),L=()=>{r.value=null},O=async()=>{if(u.value.length===0){_.warning("Please select at least one file");return}U.value=!0,r.value=null;try{const s=new FormData;u.value.forEach($=>{s.append("file",$.raw)});const e=ie(),i=e.getAuthHeader(),d={};i&&(d.Authorization=i);const p=await fetch("/funeral_addition/write/upload/dockertar",{method:"POST",headers:d,body:s,credentials:"include"});if(p.status===401)throw e.logout(),new Error("Authentication required. Please log in.");if(!p.ok)throw new Error(`Upload failed: ${p.statusText}`);const c=await p.json();r.value={success:!0,...c},u.value=[],_.success("Docker tar file uploaded and analyzed successfully!")}catch(s){console.error("Upload error:",s),r.value={success:!1,error:s.message},_.error(s.message||"Upload failed")}finally{U.value=!1}},D=async s=>{try{await navigator.clipboard.writeText(s),_.success("Copied to clipboard")}catch{_.error("Failed to copy to clipboard")}};return(s,e)=>{const i=ae,d=G,p=q,c=K,$=Q,F=Y,W=X,k=le,H=te,x=oe,M=se,S=ne,y=re,A=ue,j=de;return f(),b("div",me,[e[25]||(e[25]=a("div",{class:"page-header"},[a("h1",null,"Upload Image")],-1)),t(x,{class:"upload-tar-card"},{header:l(()=>[a("div",fe,[e[10]||(e[10]=a("span",null,"ðŸ“¦ Upload Docker Tar File",-1)),t(i,{type:"success"},{default:l(()=>[...e[9]||(e[9]=[n("New Feature",-1)])]),_:1})])]),default:l(()=>[a("div",_e,[t(p,{ref_key:"uploadRef",ref:N,"file-list":u.value,"onUpdate:fileList":e[0]||(e[0]=o=>u.value=o),class:"tar-uploader",drag:"",action:"#",accept:".tar,.tar.gz,.tgz,.zip","auto-upload":!1,"before-upload":P,"on-remove":L,multiple:""},{tip:l(()=>[...e[11]||(e[11]=[a("div",{class:"el-upload__tip"},[n(" Supports: .tar, .tar.gz, .tgz, and .zip (containing tar files)"),a("br"),n(" Use "),a("code",null,"docker save image:tag -o image.tar"),n(" to create tar file ")],-1)])]),default:l(()=>[t(d,{class:"el-icon--upload"},{default:l(()=>[t(h(J))]),_:1}),e[12]||(e[12]=a("div",{class:"el-upload__text"},[n(" Drop Docker tar file here or "),a("em",null,"click to upload")],-1))]),_:1},8,["file-list"]),a("div",ve,[t(c,{type:"primary",loading:U.value,disabled:u.value.length===0,onClick:O},{default:l(()=>[...e[13]||(e[13]=[n(" Upload and Analyze ",-1)])]),_:1},8,["loading","disabled"])]),r.value?(f(),b("div",ge,[t($,{title:r.value.success?"Upload successful!":"Upload failed",type:r.value.success?"success":"error",closable:!1,"show-icon":""},null,8,["title","type"]),r.value.repositories?(f(),b("div",ye,[e[15]||(e[15]=a("h4",null,"ðŸ“Š Analysis Results:",-1)),t(W,{column:1,border:""},{default:l(()=>[t(F,{label:"Repositories Found"},{default:l(()=>[(f(!0),b(Z,null,ee(r.value.repositories,o=>(f(),pe(i,{key:o,type:"info",class:"result-tag"},{default:l(()=>[n(E(o),1)]),_:2},1024))),128))]),_:1}),t(F,{label:"Manifests"},{default:l(()=>{var o;return[n(E(((o=r.value.manifests)==null?void 0:o.length)||0),1)]}),_:1}),t(F,{label:"Blobs"},{default:l(()=>{var o;return[n(E(((o=r.value.blobs)==null?void 0:o.length)||0),1)]}),_:1})]),_:1}),r.value.manifests?(f(),b("div",be,[e[14]||(e[14]=a("h4",null,"ðŸ“‹ Image Tags Found:",-1)),t(H,{data:r.value.manifests,border:"",stripe:"",style:{width:"100%"}},{default:l(()=>[t(k,{prop:"repository",label:"Repository"}),t(k,{prop:"tag",label:"Tag"}),t(k,{prop:"configDigest",label:"Config Digest","show-overflow-tooltip":""}),t(k,{label:"Layers",width:"100"},{default:l(o=>[t(i,{size:"small"},{default:l(()=>{var B;return[n(E(((B=o.row.layerDigests)==null?void 0:B.length)||0),1)]}),_:2},1024)]),_:1})]),_:1},8,["data"])])):I("",!0)])):I("",!0)])):I("",!0)])]),_:1}),t(M,{"content-position":"center"},{default:l(()=>[...e[16]||(e[16]=[n("OR",-1)])]),_:1}),t(x,{class:"upload-card"},{header:l(()=>[...e[17]||(e[17]=[a("div",{class:"card-header"},[a("span",null,"Docker Push Guide")],-1)])]),default:l(()=>[a("div",ke,[a("div",we,[e[19]||(e[19]=a("h3",null,"Step 1: Tag your image",-1)),a("div",he,[t(S,{type:"info"},{default:l(()=>[...e[18]||(e[18]=[n("Use the following command to tag your Docker image:",-1)])]),_:1}),t(y,{modelValue:T.value,"onUpdate:modelValue":e[2]||(e[2]=o=>T.value=o),readonly:"",class:"command-input"},{append:l(()=>[t(c,{onClick:e[1]||(e[1]=o=>D(T.value))},{default:l(()=>[t(d,null,{default:l(()=>[t(h(R))]),_:1})]),_:1})]),_:1},8,["modelValue"])])]),a("div",Ee,[e[21]||(e[21]=a("h3",null,"Step 2: Push to registry",-1)),a("div",Ue,[t(S,{type:"info"},{default:l(()=>[...e[20]||(e[20]=[n("Then push the tagged image to this registry:",-1)])]),_:1}),t(y,{modelValue:z.value,"onUpdate:modelValue":e[4]||(e[4]=o=>z.value=o),readonly:"",class:"command-input"},{append:l(()=>[t(c,{onClick:e[3]||(e[3]=o=>D(z.value))},{default:l(()=>[t(d,null,{default:l(()=>[t(h(R))]),_:1})]),_:1})]),_:1},8,["modelValue"])])]),a("div",Ve,[e[23]||(e[23]=a("h3",null,"Step 3: Authenticate (Optional)",-1)),a("div",Te,[t(S,{type:"info"},{default:l(()=>[...e[22]||(e[22]=[n("If authentication is required, login first:",-1)])]),_:1}),t(y,{modelValue:C.value,"onUpdate:modelValue":e[6]||(e[6]=o=>C.value=o),readonly:"",class:"command-input"},{append:l(()=>[t(c,{onClick:e[5]||(e[5]=o=>D(C.value))},{default:l(()=>[t(d,null,{default:l(()=>[t(h(R))]),_:1})]),_:1})]),_:1},8,["modelValue"])])])])]),_:1}),t(x,{class:"config-card"},{header:l(()=>[...e[24]||(e[24]=[a("div",{class:"card-header"},[a("span",null,"Configuration")],-1)])]),default:l(()=>[t(j,{"label-width":"120px"},{default:l(()=>[t(A,{label:"Repository Name"},{default:l(()=>[t(y,{modelValue:v.value,"onUpdate:modelValue":e[7]||(e[7]=o=>v.value=o),placeholder:"my-app"},null,8,["modelValue"])]),_:1}),t(A,{label:"Image Tag"},{default:l(()=>[t(y,{modelValue:g.value,"onUpdate:modelValue":e[8]||(e[8]=o=>g.value=o),placeholder:"latest"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})])}}},Be=ce(ze,[["__scopeId","data-v-11edac07"]]);export{Be as default};
