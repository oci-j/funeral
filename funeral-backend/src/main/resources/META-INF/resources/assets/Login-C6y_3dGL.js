import{aa as B,r as d,ag as C,c as y,o as c,d as o,w as a,ae as N,au as S,g as b,b as f,a as _,K,av as A,af as q,aw as D,s as g,l as I,t as M,S as P,J as T,i as z,D as G,G as J,A as j}from"./index-i_-dMvRT.js";import{_ as H}from"./el-input-BtvPs5Ei.js";/* empty css                     *//* empty css                *//* empty css                 *//* empty css                    */const O={class:"login-page"},Q={key:2,class:"error-message"},W={class:"login-info"},X={__name:"Login",setup(Y){const E=j(),V=J(),v=B(),m=d(),p=d(!1),n=d(""),s=d(!1),l=C({username:"",password:""}),x={username:[{required:!0,message:"Please input username",trigger:"blur"}],password:[{required:!0,message:"Please input password",trigger:"blur"}]},u=async()=>{if(!(!s.value&&!m.value)&&!(!s.value&&!await m.value.validate())){p.value=!0,n.value="";try{let t;if(s.value?t=await v.loginAnonymous():t=await v.login(l.username,l.password),t.success){G.success(s.value?"Anonymous access enabled":"Login successful");const e=V.query.redirect||"/";E.push(e)}else n.value=t.error||(s.value?"Anonymous access failed":"Login failed")}catch(t){n.value=t.message||(s.value?"Anonymous access failed":"Login failed")}finally{p.value=!1}}};return l.username="admin",l.password="password",(t,e)=>{const w=K,i=q,k=D,h=I,L=P,R=T,F=N,U=z;return c(),y("div",O,[o(U,{class:"login-card"},{header:a(()=>[...e[3]||(e[3]=[_("div",{class:"login-header"},[_("h2",null,"FUNERAL Registry Login")],-1)])]),default:a(()=>[o(F,{ref_key:"loginFormRef",ref:m,model:l,rules:s.value?{}:x,"label-width":"80px",class:"login-form",onSubmit:S(u,["prevent"])},{default:a(()=>[s.value?f("",!0):(c(),b(i,{key:0,label:"Username",prop:"username"},{default:a(()=>[o(w,{modelValue:l.username,"onUpdate:modelValue":e[0]||(e[0]=r=>l.username=r),placeholder:"Enter username","prefix-icon":"User",onKeyup:A(u,["enter"])},null,8,["modelValue"])]),_:1})),s.value?f("",!0):(c(),b(i,{key:1,label:"Password",prop:"password"},{default:a(()=>[o(w,{modelValue:l.password,"onUpdate:modelValue":e[1]||(e[1]=r=>l.password=r),type:"password",placeholder:"Enter password","prefix-icon":"Lock","show-password":"",onKeyup:A(u,["enter"])},null,8,["modelValue"])]),_:1})),o(i,null,{default:a(()=>[o(k,{modelValue:s.value,"onUpdate:modelValue":e[2]||(e[2]=r=>s.value=r)},{default:a(()=>[...e[4]||(e[4]=[g(" Anonymous Access ",-1)])]),_:1},8,["modelValue"])]),_:1}),o(i,null,{default:a(()=>[o(h,{type:"primary",loading:p.value,class:"login-button",onClick:u},{default:a(()=>[g(M(s.value?"Access as Anonymous":"Login"),1)]),_:1},8,["loading"])]),_:1}),n.value?(c(),y("div",Q,[o(L,{title:n.value,type:"error",closable:!1,"show-icon":""},null,8,["title"])])):f("",!0),_("div",W,[o(R,{type:"info",size:"small"},{default:a(()=>[...e[5]||(e[5]=[g(" Default credentials: admin / password ",-1)])]),_:1})])]),_:1},8,["model","rules"])]),_:1})])}}},le=H(X,[["__scopeId","data-v-5e409020"]]);export{le as default};
